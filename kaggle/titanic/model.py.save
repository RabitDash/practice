import numpy as np
import pandas as pd
import keras
import preprocessing

data, truth = preprocessing.titanic_data()
class Model:
	seq= keras.models.Sequential()	seq.add(keras.layers.Dense(2,use_bias=False, input_shape=(8,)))
seq.add(keras.layers.Dropout(0.5))
seq.compile(optimizer='adadelta', loss='binary_crossentropy')
seq.fit(data, truth, epochs=500, validation_split=0.05)
prediction = seq.predict(data)
seq.save('model.h5')
def one_hot(e):
    if e[0] < e[1]:
        return [0,1]
    else:
        return [1,0]
prediction = list(map(one_hot, prediction))
truth = list(map(one_hot, truth))
count = 0
for (x,y) in zip(prediction, truth):
    if x == y:
        count += 1
print("accurate rate:{}".format(count/891.0))
