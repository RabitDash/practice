# 朴素贝叶斯进行垃圾短信分类
贝叶斯定理也称贝叶斯推理，早在18世纪，英国学者贝叶斯(1702～1763)曾提出计算条件概率的公式用来解决如下一类问题：假设H[1],H[2]…,H[n]互斥且构成一个完全事件，已知它们的概率P(H[i]),i=1,2,…,n,现观察到某事件A与H[,1],H[,2]…,H[,n]相伴随机出现，且已知条件概率P(A/H[,i])，求P(H[,i]/A)。
贝叶斯公式（发表于1763年）为：

### P(H[i]|A)=P(H[i]) \* P(A│H[i])/{P(H[1]) \*P(A│H[1]) +P(H[2])\*P(A│H[2])+…+P(H[n])\*P(A│H[n])}

对其进行重新表示。

P(Ai|B)=P(B|Ai)P(Ai)∑ni=1P(B|Ai)P(Ai)(公式1)
其中 Ai,…,An 为完备事件组，即 ⋃ni=1Ai=Ω,Ai⋂Aj=ϕ,P(Ai)>0 。

推导过程：

对于两个关联事件A和B，同时发生的概率为：P(AB)=P(A|B)P(B)=P(B|A)P(A) 。因此可以得到：

P(A|B)=P(B|A)P(A)P(B)
其中，P(B)=P(B|A)P(A)+P(B|A¯¯¯¯)P(A¯¯¯¯) 。因此可以得到。

P(A|B)=P(B|A)P(A)P(B|A)P(A)+P(B|A¯¯¯¯)P(A¯¯¯¯)(公式2)
公式1如果A只有两种情况，则为公式2。

1.输入所有邮件，然后得到邮件中每个单词出现在垃圾邮件中的次数，出现在正常邮件中的次数，垃圾邮件有多少封，正常邮件有多少封。模型就训练出来了。

2.然后输入一封待处理邮件，找到里面所有出现的关键词。求出P(A|T1,…Tn)，A为一封邮件是垃圾邮件的事件，T为关键词出现在一封邮件中的事件。T1,…Tn是多个关键词。A和T是关联的事件。T1,…Tn每个关键词根据朴素贝叶斯的假设，是相互独立的。P(A|T1,…Tn) 为 T1,…Tn 这些关键词同时出现的情况下A是垃圾邮件的概率。

P(A|T1,…Tn)=P(T1,…Tn|A)P(A)P(T1,…Tn)=P(T1|A)P(T2|A)…P(Tn−1|A)P(Tn|A)P(A)P(T1)P(T2)…P(Tn−1)P(Tn)(公式3)
P(A|T1,…Tn)求出之后，就得到一个概率，我们可以自己设置一个阈值，比如说概率大于85%时，认为此邮件为垃圾邮件。

3.一封邮件可以确定之后，我们可以从数据集中随机选取一部分邮件作为测试集，测试这些邮件的效果，得到测试的召回率和准确率，然后评价算法的效果。
